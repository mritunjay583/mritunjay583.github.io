<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Spark-Structured Streaming Offset Management APIs #  spark-structured streaming has it&rsquo;s own offset management it does not
support storing consumed offset information in consumer group in kafka.
It uses checkpoint location which you provide. we are using s3 as
checkpoint location. Currently there is no APIs in spark-structured
streaming using which we can get information of currently consumed
offsets or reset offsets for current pipeline. We created APIs which
will do all of this work.">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="Offset management" />
<meta property="og:description" content="Spark-Structured Streaming Offset Management APIs #  spark-structured streaming has it&rsquo;s own offset management it does not
support storing consumed offset information in consumer group in kafka.
It uses checkpoint location which you provide. we are using s3 as
checkpoint location. Currently there is no APIs in spark-structured
streaming using which we can get information of currently consumed
offsets or reset offsets for current pipeline. We created APIs which
will do all of this work." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://mritunjay583.github.io/docs/docs/usage-guidelines/api/offset-management-apis-usage/" /><meta property="article:section" content="docs" />
<meta property="article:published_time" content="2019-03-26T08:47:11&#43;01:00" />
<meta property="article:modified_time" content="2019-03-26T08:47:11&#43;01:00" />

<title>Offset management | DATAMART</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.e246e6a45b940b6ff71d8216783f10a80d910290a7c364c8bfd5d305d8545d62.css" integrity="sha256-4kbmpFuUC2/3HYIWeD8QqA2RApCnw2TIv9XTBdhUXWI=">
<script defer src="/en.search.min.04dea4370b56e4f2b68a0b04d656bed9137be5574171370858866b5246cce744.js" integrity="sha256-BN6kNwtW5PK2igsE1la&#43;2RN75VdBcTcIWIZrUkbM50Q="></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a href="/"><span>DATAMART</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  



  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-6d87ea0de7b98d214d87150d1024f51e" class="toggle" checked />
    <label for="section-6d87ea0de7b98d214d87150d1024f51e" class="flex justify-between">
      <a href="http://mritunjay583.github.io/docs/docs/" class="">Docs</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-76e70ba71162eb688a4952e5576fd6b7" class="toggle"  />
    <label for="section-76e70ba71162eb688a4952e5576fd6b7" class="flex justify-between">
      <a href="http://mritunjay583.github.io/docs/docs/developer/" class="">Developer</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="http://mritunjay583.github.io/docs/docs/developer/db-design-solution-hld/" class="">Db-Design-Solution</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="http://mritunjay583.github.io/docs/docs/developer/db-design-use-case-problem-analysis/" class="">db-design-use-case-problem-analysis</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="http://mritunjay583.github.io/docs/docs/developer/documentation-publish/" class="">documentation publish</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="http://mritunjay583.github.io/docs/docs/developer/outcomes-limitations-support/" class="">outcomes limitations support</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="http://mritunjay583.github.io/docs/docs/developer/roadmap/" class="">Roadmap</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-e9be04ad509fc93ce902011efeae48af" class="toggle" checked />
    <label for="section-e9be04ad509fc93ce902011efeae48af" class="flex justify-between">
      <a href="http://mritunjay583.github.io/docs/docs/usage-guidelines/" class="">Usage Guidelines</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="http://mritunjay583.github.io/docs/docs/usage-guidelines/create-indexes-in-dmdb-guidlines/" class="">create index in dmdb</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="http://mritunjay583.github.io/docs/docs/usage-guidelines/datamarts-creations-guidelines/" class="">datamart creation guidelines</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="http://mritunjay583.github.io/docs/docs/usage-guidelines/dmdb-usage-guide/" class="">dmdb usage</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="http://mritunjay583.github.io/docs/docs/usage-guidelines/metric_table-design-and-usage/" class="">metric table design</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="http://mritunjay583.github.io/docs/docs/usage-guidelines/navigation-around-views-and-tables/" class="">navigation-around-views-and-tables</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="http://mritunjay583.github.io/docs/docs/usage-guidelines/api/offset-management-apis-usage/" class=" active">Offset management</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="http://mritunjay583.github.io/docs/docs/usage-guidelines/programmatic-access-and-integration/" class="">programmatic access and Integration</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var a=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Offset management</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#offset-management-apis">Offset Management APIs</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="spark-structured-streaming-offset-management-apis">
  Spark-Structured Streaming Offset Management APIs
  <a class="anchor" href="#spark-structured-streaming-offset-management-apis">#</a>
</h1>
<p>spark-structured streaming has it&rsquo;s own offset management it does not<br>
support storing consumed offset information in consumer group in kafka.<br>
It uses checkpoint location which you provide. we are using s3 as<br>
checkpoint location. Currently there is no APIs in spark-structured<br>
streaming using which we can get information of currently consumed<br>
offsets or reset offsets for current pipeline. We created APIs which<br>
will do all of this work.</p>
<h2 id="offset-management-apis">
  Offset Management APIs
  <a class="anchor" href="#offset-management-apis">#</a>
</h2>
<p><strong>1.get currently consumed offsets by pipeline:</strong><br>
The API gives information of currently consumed offset by pipeline.</p>
<p><strong>Request:</strong></p>
<pre><code>curl -X GET -H &quot;Accept:application/json&quot; -H &quot;Content-Type:application/json&quot; localhost:9090//v1/getCurrentOffsets/?pipelineName=orion_transaction  
</code></pre>
<p><strong>Response:</strong></p>
<pre><code>{  
  &quot;Orion.Transaction.info&quot;: {  
    &quot;0&quot;: 873340,  
    &quot;1&quot;: 884664,  
    &quot;2&quot;: 879160,  
    &quot;3&quot;: 866873,  
    &quot;4&quot;: 894115,  
    &quot;5&quot;: 880421,  
    &quot;6&quot;: 868078,  
    &quot;7&quot;: 885777,  
    &quot;8&quot;: 876230  
  }  
}  
</code></pre>
<p><strong>2.get topic details:</strong><br>
The API gives detail of given topic like starting offset and ending offset of each partition.</p>
<p><strong>Request :</strong></p>
<pre><code>    curl -X GET -H &quot;Accept:application/json&quot; -H &quot;Content-Type:application/json&quot; localhost:9090//v1/getTopicDetails/?topicName=Orion.Transaction.info  
</code></pre>
<p><strong>Response:</strong></p>
<pre><code>{  
  &quot;name&quot;: &quot;Orion.Transaction.info&quot;,  
  &quot;partitions&quot;: {  
    &quot;0&quot;: {  
      &quot;firstOffset&quot;: 873340,  
      &quot;lastOffset&quot;: 898067  
    },  
    &quot;1&quot;: {  
      &quot;firstOffset&quot;: 884664,  
      &quot;lastOffset&quot;: 909803  
    },  
    &quot;2&quot;: {  
      &quot;firstOffset&quot;: 879160,  
      &quot;lastOffset&quot;: 904819  
    },  
    &quot;3&quot;: {  
      &quot;firstOffset&quot;: 866873,  
      &quot;lastOffset&quot;: 892826  
    },  
    &quot;4&quot;: {  
      &quot;firstOffset&quot;: 894115,  
      &quot;lastOffset&quot;: 917581  
    },  
    &quot;5&quot;: {  
      &quot;firstOffset&quot;: 880421,  
      &quot;lastOffset&quot;: 905385  
    },  
    &quot;6&quot;: {  
      &quot;firstOffset&quot;: 868078,  
      &quot;lastOffset&quot;: 893108  
    },  
    &quot;7&quot;: {  
      &quot;firstOffset&quot;: 885777,  
      &quot;lastOffset&quot;: 908980  
    },  
    &quot;8&quot;: {  
      &quot;firstOffset&quot;: 876230,  
      &quot;lastOffset&quot;: 902482  
    }  
  }  
}  
</code></pre>
<p><strong>3.reset offset of all partitions to earliest:</strong><br>
The API reset’s offset of the consumer to the earliest offset of each partition.</p>
<p><strong>Request:</strong></p>
<pre><code>curl -X GET -H &quot;Accept:application/json&quot; -H &quot;Content-Type:application/json&quot; localhost:9090//v1/resetOffsetOfAllPartitionsToEarliest/?pipelineName=orion_transaction  
</code></pre>
<p><strong>Response:</strong></p>
<pre><code>{  
  &quot;Orion.Transaction.info&quot;: {  
    &quot;0&quot;: 873340,  
    &quot;1&quot;: 884664,  
    &quot;2&quot;: 879160,  
    &quot;3&quot;: 866873,  
    &quot;4&quot;: 894115,  
    &quot;5&quot;: 880421,  
    &quot;6&quot;: 868078,  
    &quot;7&quot;: 885777,  
    &quot;8&quot;: 876230  
  }  
}  
</code></pre>
<p><strong>4.reset offset of all partitions to latest:</strong><br>
The API reset’s offset of the consumer to the latest offset of each partition.</p>
<p><strong>Request:</strong></p>
<pre><code>curl -X GET -H &quot;Accept:application/json&quot; -H &quot;Content-Type:application/json&quot; localhost:9090//v1/resetOffsetOfAllPartitionsToLatest/?pipelineName=orion_transaction  
</code></pre>
<p><strong>Response:</strong></p>
<pre><code>{  
  &quot;Orion.Transaction.info&quot;: {  
    &quot;0&quot;: 898071,  
    &quot;1&quot;: 909810,  
    &quot;2&quot;: 904827,  
    &quot;3&quot;: 892828,  
    &quot;4&quot;: 917590,  
    &quot;5&quot;: 905389,  
    &quot;6&quot;: 893126,  
    &quot;7&quot;: 908987,  
    &quot;8&quot;: 902492  
  }  
}  
</code></pre>
<p><strong>5.reset offset of partition:</strong><br>
The API reset’s offset of the consumer to the specified offset at partition level. We specify all number of partitions that exist in the topic. This api is useful when we want to want to reset offset to a custom pre-calculated offset for each partition.</p>
<p><strong>Request:</strong></p>
<pre><code>curl -X GET -H &quot;Accept:application/json&quot; -H &quot;Content-Type:application/json&quot; localhost:9090//v1/resetOffsetOfPartitions/?pipelineName=orion_transaction  -d @offset.json  

offset.json file content  
{  
  &quot;Orion.Transaction.info&quot;: {  
    &quot;0&quot;: 0,  
    &quot;1&quot;: 895788,  
    &quot;2&quot;: 890201,  
    &quot;3&quot;: 877647,  
    &quot;4&quot;: 904420,  
    &quot;5&quot;: 891558,  
    &quot;6&quot;: 879249,  
    &quot;7&quot;: 896014,  
    &quot;8&quot;: 887096  
  }  
}  
</code></pre>
<p><strong>Response:</strong></p>
<pre><code>{  
  &quot;Orion.Transaction.info&quot;: {  
    &quot;0&quot;: 0,  
    &quot;1&quot;: 895788,  
    &quot;2&quot;: 890201,  
    &quot;3&quot;: 877647,  
    &quot;4&quot;: 904420,  
    &quot;5&quot;: 891558,  
    &quot;6&quot;: 879249,  
    &quot;7&quot;: 896014,  
    &quot;8&quot;: 887096  
  }  
}
</code></pre>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#offset-management-apis">Offset Management APIs</a></li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












